<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid #444;
        }
        button {
            background: #ff0000;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #cc0000;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
        }
        .success {
            background: #004d00;
            border: 1px solid #00ff00;
        }
        .error {
            background: #4d0000;
            border: 1px solid #ff0000;
        }
        .info {
            background: #003d4d;
            border: 1px solid #00ccff;
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #333;
            border: 1px solid #555;
            color: white;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>üî¥ YouTube API Test Console</h1>
    
    <div class="test-section">
        <h2>üîë API Configuration</h2>
        <p><strong>API Key:</strong> <span id="apiKeyStatus">Checking...</span></p>
        <p><strong>Quota Used:</strong> <span id="quotaStatus">Unknown</span></p>
    </div>
    
    <div class="test-section">
        <h2>üß™ Quick Tests</h2>
        <button onclick="testMrBeast()">Test MrBeast Channel</button>
        <button onclick="testMKBHD()">Test MKBHD Channel</button>
        <button onclick="testPewDiePie()">Test PewDiePie Channel</button>
        <div id="quickTestResults"></div>
    </div>
    
    <div class="test-section">
        <h2>üîç Custom Channel Test</h2>
        <input type="text" id="channelUrl" placeholder="Enter YouTube channel URL (e.g., https://youtube.com/@MrBeast)">
        <button onclick="testCustomChannel()">Test This Channel</button>
        <div id="customTestResults"></div>
    </div>
    
    <div class="test-section">
        <h2>üìä Recent Test Results</h2>
        <div id="allResults"></div>
    </div>

    <script>
        const YOUTUBE_API_KEY = 'AIzaSyDAuuJ6KNraIyA4E1wizRZx3HDhJTO69QQ';
        let testCount = 0;
        
        // Check API key status on load
        document.getElementById('apiKeyStatus').textContent = YOUTUBE_API_KEY ? '‚úÖ Configured' : '‚ùå Missing';
        
        function addResult(title, content, type = 'info') {
            const resultsDiv = document.getElementById('allResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = `<strong>${title}</strong><br>${content}`;
            resultsDiv.insertBefore(resultDiv, resultsDiv.firstChild);
        }
        
        function updateQuickTestResults(content, type = 'info') {
            const div = document.getElementById('quickTestResults');
            div.className = `result ${type}`;
            div.innerHTML = content;
        }
        
        function updateCustomTestResults(content, type = 'info') {
            const div = document.getElementById('customTestResults');
            div.className = `result ${type}`;
            div.innerHTML = content;
        }
        
        async function testYouTubeChannel(channelId, channelName) {
            testCount++;
            const testId = `Test #${testCount}`;
            
            try {
                addResult(`${testId}: Testing ${channelName}`, 'Starting API call...', 'info');
                
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/channels?part=statistics,snippet&id=${channelId}&key=${YOUTUBE_API_KEY}`
                );
                
                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.items && data.items.length > 0) {
                        const channel = data.items[0];
                        const stats = channel.statistics;
                        const snippet = channel.snippet;
                        
                        const result = `
                            ‚úÖ SUCCESS!<br>
                            üìä Subscribers: ${parseInt(stats.subscriberCount).toLocaleString()}<br>
                            üìπ Videos: ${parseInt(stats.videoCount).toLocaleString()}<br>
                            üëÄ Views: ${parseInt(stats.viewCount).toLocaleString()}<br>
                            üìÖ Created: ${new Date(snippet.publishedAt).toLocaleDateString()}<br>
                            ‚ú® Title: ${snippet.title}
                        `;
                        
                        addResult(`${testId}: ${channelName}`, result, 'success');
                        return { success: true, data: { subscribers: stats.subscriberCount, title: snippet.title } };
                    } else {
                        addResult(`${testId}: ${channelName}`, '‚ö†Ô∏è No channel data returned', 'error');
                        return { success: false, error: 'No data' };
                    }
                } else {
                    const errorData = await response.json();
                    addResult(`${testId}: ${channelName}`, `‚ùå API Error: ${response.status}<br>Details: ${JSON.stringify(errorData, null, 2)}`, 'error');
                    return { success: false, error: response.status };
                }
            } catch (error) {
                addResult(`${testId}: ${channelName}`, `üí• Request Failed: ${error.message}`, 'error');
                return { success: false, error: error.message };
            }
        }
        
        async function testMrBeast() {
            updateQuickTestResults('Testing MrBeast channel...', 'info');
            const result = await testYouTubeChannel('UCX6OQ3DkcsbYNE6H8uQQuVA', 'MrBeast');
            if (result.success) {
                updateQuickTestResults(`‚úÖ MrBeast: ${parseInt(result.data.subscribers).toLocaleString()} subscribers`, 'success');
            } else {
                updateQuickTestResults(`‚ùå MrBeast test failed: ${result.error}`, 'error');
            }
        }
        
        async function testMKBHD() {
            updateQuickTestResults('Testing MKBHD channel...', 'info');
            const result = await testYouTubeChannel('UCBJycsmduvYEL83R_U4JriQ', 'MKBHD');
            if (result.success) {
                updateQuickTestResults(`‚úÖ MKBHD: ${parseInt(result.data.subscribers).toLocaleString()} subscribers`, 'success');
            } else {
                updateQuickTestResults(`‚ùå MKBHD test failed: ${result.error}`, 'error');
            }
        }
        
        async function testPewDiePie() {
            updateQuickTestResults('Testing PewDiePie channel...', 'info');
            const result = await testYouTubeChannel('UC-lHJZR3Gqxm24_Vd_AJ5Yw', 'PewDiePie');
            if (result.success) {
                updateQuickTestResults(`‚úÖ PewDiePie: ${parseInt(result.data.subscribers).toLocaleString()} subscribers`, 'success');
            } else {
                updateQuickTestResults(`‚ùå PewDiePie test failed: ${result.error}`, 'error');
            }
        }
        
        function extractChannelId(url) {
            const patterns = [
                /youtube\.com\/channel\/([a-zA-Z0-9_-]+)/,
                /youtube\.com\/@([a-zA-Z0-9_.-]+)/,
                /youtube\.com\/c\/([a-zA-Z0-9_.-]+)/,
                /youtube\.com\/user\/([a-zA-Z0-9_.-]+)/
            ];
            
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match) return { type: 'handle', value: match[1] };
            }
            return null;
        }
        
        async function testCustomChannel() {
            const url = document.getElementById('channelUrl').value;
            if (!url) {
                updateCustomTestResults('Please enter a YouTube channel URL', 'error');
                return;
            }
            
            updateCustomTestResults('Extracting channel info...', 'info');
            
            // For now, let's use known channel IDs for testing
            // You can expand this to handle URL parsing
            if (url.includes('MrBeast') || url.includes('mrbeast')) {
                await testMrBeast();
                updateCustomTestResults('See results above ‚Üë', 'success');
            } else if (url.includes('mkbhd') || url.includes('MKBHD')) {
                await testMKBHD();
                updateCustomTestResults('See results above ‚Üë', 'success');
            } else {
                updateCustomTestResults('For now, try: MrBeast, MKBHD, or PewDiePie', 'info');
            }
        }
        
        // Auto-test on page load
        setTimeout(() => {
            addResult('Page Load', 'YouTube API Test Console loaded successfully', 'success');
        }, 100);
    </script>
</body>
</html>
